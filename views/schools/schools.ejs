  <%- include("../partials/header") %>

<div class="jumbotron">
  <h1 class="display-4">All Schools</h1>
</div>

<div class="row">
  <% if (schools && schools.length > 0) { %>
    <% schools.forEach(school => { %>
      <div class="col-md-3 col-sm-6">
        <a href="/schools/<%= school.slug %>" class="card-link">
          <div class="card text-center">
            <img class="card-img-top" src="<%= school.image %>" alt="No Image">
            <div class="card-body">
              <h5 class="card-title">
                <%= school.name %>
              </h5>
              <% if (!school.averageRating) { %>
              <p>
                No Rating Yet
              </p>
              <% } else { %>
              <p>
                <span>
                  <i class="fas fa-star <% if (school.averageRating >= 1.0) { %> checked <% } %>"></i>
                  <i class="fas fa-star <% if (school.averageRating >= 1.5) { %> checked <% } %>"></i>
                  <i class="fas fa-star <% if (school.averageRating >= 2.5) { %> checked <% } %>"></i>
                  <i class="fas fa-star <% if (school.averageRating >= 3.5) { %> checked <% } %>"></i>
                  <i class="fas fa-star <% if (school.averageRating >= 4.5) { %> checked <% } %>"></i>
                </span>
              </p>
              <% } %>
              <span class="badge badge-secondary mb-2">
                <i class="fas fa-thumbs-up"></i> Like: <%= school.likes.length %>
              </span>
              <span class="badge badge-secondary mb-2">
                <i class="fas fa-comment-dots"></i> Review: <%= school.reviews.length %>
              </span>
            </div>
          </div>
        </a>
      </div>
    <% }); %>
  <% } else { %>
    <div class="container">
      <p class="h3">School not found</p>
    </div>
  <% } %>
</div>

<!-- Pagination -->
<% if (pages && pages > 0) { %>
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <% if (currentPage === 1) { %>
    <li class="page-item disabled">
      <a class="page-link">First</a>
    </li>
    <% } else { %>
    <li>
      <a class="page-link" href="/schools">First</a>
    </li>
    <% } %>

    <% if (currentPage == 1) { %>
    <li class="page-item disabled">
      <a class="page-link" area-label="Previous">«</a>
    </li>
    <% } else { %>
    <li>
      <a class="page-link" href="/schools?page=<%= currentPage - 1 %>">«</a>
    </li>
    <% } %>

    <% let i = (currentPage > 5 ? currentPage - 4 : 1) %>
    <% if (i !== 1) { %>
    <li class="page-item disabled">
      <a class="page-link">...</a>
    </li>
    <% } %>
    <% for (; i <= (currentPage + 4) && i <= pages; i++) { %>
    <% if (i == currentPage) { %>
    <li class="active">
      <a class="page-link"><%= i %></a>
    </li>
    <% } else { %>
    <li>
      <a class="page-link" href="/schools?page=<%= i %>"><%= i %></a>
    </li>
    <% } %>
    <% if (i == currentPage + 4 && i < pages) { %>
    <li class="page-item disabled">
      <a class="page-link">...</a>
    </li>
    <% } %>
    <% } %>

    <% if (currentPage == pages) { %>
    <li class="page-item disabled" area-label="Next">
      <a class="page-link">»</a>
    </li>
    <% } else { %>
    <li>
      <a class="page-link" href="/schools?page=<%= currentPage + 1 %>">»</a>
    </li>
    <% } %>

    <% if (currentPage == pages) { %>
    <li class="page-item disabled">
      <a class="page-link">Last</a>
    </li>
    <% } else { %>
    <li>
      <a class="page-link" href="/schools?page=<%= pages %>">Last</a>
    </li>
    <% } %>
  </ul>
</nav>
<% } %>

<hr>
<a class="btn btn-primary" href="/schools/new" role="button">
  <i class="fas fa-plus"></i> Add New School
</a>

<%- include("../partials/footer") %>